(this["webpackJsonpalarm-ui"]=this["webpackJsonpalarm-ui"]||[]).push([[0],{101:function(e,t,n){},103:function(e,t,n){},104:function(e,t,n){},213:function(e,t,n){},214:function(e,t,n){},217:function(e,t,n){"use strict";n.r(t);var s=n(3),r=n(0),a=n.n(r),c=n(89),i=n.n(c),o=(n(101),n(19)),d=n(37),l=n(5),u=n(34),j=function(e){return!(!e||"object"!==typeof e)&&("string"===typeof e.sensorId&&("string"===typeof e.type&&"string"===typeof e.name))},b=function(){var e=window.localStorage.getItem("sensor-info");if(!e)return[];try{return JSON.parse(e)}catch(t){return console.log("Error parsing data",t),[]}},h=function(e){if(!Array.isArray(e)||e.length<1)return!1;var t,n=Object(u.a)(e);try{for(n.s();!(t=n.n()).done;){var s=t.value;if(!j(s))return!1}}catch(r){n.e(r)}finally{n.f()}return window.localStorage.setItem("sensor-info",JSON.stringify(e)),!0},f=n(20),O=n.n(f),p=n(21),v=n(35),x="https://actionizer.sew.ovh",m=function(e){return!!e.errorCode};function C(e){return y.apply(this,arguments)}function y(){return(y=Object(v.a)(O.a.mark((function e(t){var n,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((n=Array.isArray(t)?t:[t]).length<1)){e.next=3;break}return e.abrupt("return",[]);case 3:return e.next=5,fetch(x,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});case 5:if(200!==(s=e.sent).status){e.next=8;break}return e.abrupt("return",s.json());case 8:return e.abrupt("return",{errorCode:s.status});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}n(103);var S=function(e,t,n){var s,r=Object(u.a)(n);try{for(r.s();!(s=r.n()).done;){var a=s.value;if(a.action.sensorId===e&&200===a.status)return a.action.payload}}catch(c){r.e(c)}finally{r.f()}return-1},N=function(e){var t=e.sensor,n=r.useState({payload:0,loading:!1}),a=Object(o.a)(n,2),c=a[0],i=a[1],d=r.useCallback(function(){var e=Object(v.a)(O.a.mark((function e(n){var s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i((function(e){return Object(p.a)(Object(p.a)({},e),{},{loading:!0})})),e.next=4,C({sensorId:t.sensorId,type:t.type,payload:n});case 4:s=e.sent,i((function(e){return{payload:m(s)?-1:S(t.sensorId,e.payload,s),loading:!1}})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),i((function(e){return{payload:-1,loading:!1}}));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),[t]);return r.useEffect((function(){d(0)}),[d]),Object(s.jsxs)("button",{className:"ButtonSwitch","data-testid":"sew-switch-button-".concat(t.sensorId),onClick:function(){return d(0===c.payload?1:0)},disabled:c.loading,style:{backgroundColor:t.color},children:[Object(s.jsx)("div",{className:"ButtonSwitchState",children:c.loading?"Loading":1===c.payload?"ON":-1===c.payload?"??":"OFF"}),Object(s.jsx)("div",{className:"ButtonSwitchName",children:t.name})]})},g=(n(104),function(e){var t=e.sensors;return!Array.isArray(t)||t.length<1?Object(s.jsxs)("div",{children:[Object(s.jsx)("div",{children:"No Sensors found!"}),Object(s.jsx)("div",{children:"Add Sensors"})]}):Object(s.jsx)("div",{className:"ButtonsList",children:t.map((function(e){return Object(s.jsx)(N,{sensor:e},e.sensorId)}))})}),D=n(38),L=n(95),A=(n(213),["firebrick","#B80000","#DB3E00","#FCCB00","#008B02","#006B76","#1273DE","#004DCF","#5300EB"]),I=function(e,t){return Object(p.a)(Object(p.a)({},e),t)},w={sensorId:"",name:"",type:"SWITCH",color:"#DB3E00"},R=function(e){return!(!e.sensorId||e.sensorId.length<8)&&!(!e.name||e.name.length<3)},U=function(e){var t=e.addSensor,n=r.useReducer(I,w),a=Object(o.a)(n,2),c=a[0],i=a[1];return Object(s.jsxs)("div",{className:"CRUDListAdd",children:[Object(s.jsxs)("div",{className:"CRUDListAddField",children:[Object(s.jsx)("span",{className:"CRUDListAddFieldLabel",children:"Sensor ID"}),Object(s.jsx)("input",{className:"CRUDListAddFieldValue",type:"text","data-testid":"sew-sensors-crud-input-sensorid",onChange:function(e){return i({sensorId:e.target.value})},value:c.sensorId})]}),Object(s.jsxs)("div",{className:"CRUDListAddField",children:[Object(s.jsx)("span",{className:"CRUDListAddFieldLabel",children:"Sensor Name"}),Object(s.jsx)("input",{className:"CRUDListAddFieldValue",type:"text","data-testid":"sew-sensors-crud-input-name",onChange:function(e){return i({name:e.target.value})},value:c.name})]}),Object(s.jsxs)("div",{className:"CRUDListAddField",children:[Object(s.jsx)("span",{className:"CRUDListAddFieldLabel",children:"Sensor Type"}),Object(s.jsxs)("select",{className:"CRUDListAddFieldValue","data-testid":"sew-sensors-crud-select-type",onChange:function(e){return i({type:e.target.value})},value:c.type,children:[Object(s.jsx)("option",{value:"SWITCH",children:"SWITCH"}),Object(s.jsx)("option",{value:"DISTANCE",children:"DISTANCE"})]})]}),Object(s.jsxs)("div",{className:"CRUDListAddField",children:[Object(s.jsx)("span",{className:"CRUDListAddFieldLabel",children:"Sensor Color"}),Object(s.jsx)(L.a,{triangle:"hide",colors:A,className:"CRUDListAddFieldValue",color:c.color,onChangeComplete:function(e){return i({color:e.hex})}})]}),Object(s.jsx)("button",{"data-testid":"sew-sensors-crud-button-save",disabled:!R(c),onClick:function(){return t(c)},className:R(c)?"CRUDListAddButton":"CRUDListAddButtonDisabled",children:"SAVE"})]})},F=function(e){var t=e.sensors,n=e.deleteSensor;return!Array.isArray(t)||t.length<1?Object(s.jsx)("div",{className:"CRUDListNoSensors",children:Object(s.jsx)("div",{children:"No Sensors found!"})}):Object(s.jsx)("div",{className:"CRUDListSensors",children:t.map((function(e,t){return Object(s.jsxs)("div",{"data-testid":"sew-sensors-crud-list-".concat(e.sensorId),className:"CRUDListSensorsItem",style:{backgroundColor:e.color},children:[Object(s.jsxs)("div",{className:"CRUDListSensorsItemLabels",children:[Object(s.jsx)("div",{children:e.name}),Object(s.jsx)("div",{children:e.sensorId})]}),Object(s.jsx)("button",{"data-testid":"sew-sensors-crud-button-delete",onClick:function(){return n(t)},className:"CRUDListSensorsItemButton",children:"DELETE"})]},e.sensorId)}))})},B=function(e){var t=e.sensors,n=void 0===t?[]:t,r=e.onChange;return Object(s.jsxs)("div",{className:"CRUDList",children:[Object(s.jsx)(U,{addSensor:function(e){return r([].concat(Object(D.a)(n),[e]))}}),Object(s.jsx)(F,{sensors:n,deleteSensor:function(e){return r([].concat(Object(D.a)(n.slice(0,e)),Object(D.a)(n.slice(e+1))))}})]})};n(214);var T=function(){var e=r.useState((function(){return b()})),t=Object(o.a)(e,2),n=t[0],a=t[1],c=r.useCallback((function(e){h(e),a(e)}),[]);return Object(s.jsx)(d.a,{children:Object(s.jsxs)("div",{className:"App",children:[Object(s.jsx)("div",{className:"Title",children:"Alarm UI"}),Object(s.jsx)("div",{className:"Body",children:Object(s.jsxs)(l.c,{children:[Object(s.jsx)(l.a,{path:"/sensors",children:Object(s.jsx)(B,{sensors:n,onChange:c})}),Object(s.jsx)(l.a,{path:"/",children:Object(s.jsx)(g,{sensors:n})})]})}),Object(s.jsxs)("div",{className:"Sections",children:[Object(s.jsx)(d.b,{to:"/",exact:!0,className:"TabSection",activeClassName:"TabSectionSelected",children:"Buttons"}),Object(s.jsx)(d.b,{to:"/sensors",className:"TabSection",activeClassName:"TabSectionSelected",children:"Sensors"})]})]})})},k=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,219)).then((function(t){var n=t.getCLS,s=t.getFID,r=t.getFCP,a=t.getLCP,c=t.getTTFB;n(e),s(e),r(e),a(e),c(e)}))};i.a.render(Object(s.jsx)(a.a.StrictMode,{children:Object(s.jsx)(T,{})}),document.getElementById("root")),k()}},[[217,1,2]]]);
//# sourceMappingURL=main.4662e33e.chunk.js.map